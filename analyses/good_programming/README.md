# Literate and reproducible programming

Your own programs serve two related purposes. First, there is the obvious 
purpose of executing the analysis. Second, though, is a goal that is just as 
important to science as the analysis itself - recording the steps of the 
analysis so that it is fully reproducible.

Your code and your commentary can be in separate files, such as an R script with 
command and a notebook with a description and interpretation of what you did.

But since the code and your notebook both serve different parts of the same 
purpose (ie, recording what you did) it can be more 
convenient and clear to combine them into a single file. This file is  
executable by the computer, allowing you to quickly revise and update your 
analyses, and allowing others to reproduce and modify them. It is also 
human-readable, allowing anyone (including you) to understand the intent, 
implementation, and results of your work.


# Embed your notebook into your code as comments

One approach to integrating your code and notebook is to embed your notebook as 
comments right into your program. Comments are bits of text in your program 
file that aren't executed, they are intended only for people that read the 
program file itself. In many languages, including R and Python, text after a 
`#` is ignored when the program is run.

Your analysis could, for example, consist of a file named `my_analysis.r`. See 
the example file in this directory by this name.

You can then run your analysis by entering the following at the command line:

    R CMD BATCH my_analysis.r
    
This will execute the code and generate two new files. `Rplots.pdf` has the 
plots that were generated by the script. `my_analysis.r.Rout` has the text 
output of the analysis.

The `my_analysis.r` file includes all the code needed to execute the analysis, 
a description of the intent and primary question, comments on how the code 
runs, and my interpretations of the results as they pertain to the original 
question. I have achieved all the goals of executing and documenting my 
analyses in a single file.

The nice thing about this approach is that it is very simple and quite general- 
writing well commented code is good practice no matter the language, and you 
can always add in as much as you like if you want to turn the comments into full 
blown analysis documentation.

But there are a few few things that are inconvenient. In particular, the results 
of the analysis are disembodied from the code and supporting discussion. 
Anyone that reviews the analysis (including yourself) will have to flip between 
three files - the source, the text output, and the plots. In addition, the 
formatting of the code comments is quite limitting. No bold or typeset equations 
here.

# Embed your code in your notebook

There are a series of new tools that allow you to embed your code into a
document, and then generate a data report that include the text from the 
document, the code, and the results of executing the code. One such tool is 
[knitr](http://yihui.name/knitr/). 

You can share the source file and the 
report. Providing both allows others to reproduce and modify our analyses, and 
also to take a look at what you did without needing to recompute it all 
themselves. knitr can be used to organize your analyses as you do them, to 
generate supplementary files for a manuscript, or even to generate a manuscript 
itself. 

knitr supports multiple document markup languages, including 
[LaTeX](http://www.latex-project.org) and 
[Markdown](http://daringfireball.net/projects/markdown/). LaTeX is generally 
used to generate pdf reports and Markdown to generate html reports, though, 
with some trouble, any format of report can be produced from any markup 
language. Markdown is simpler to learn than LaTeX, and is a good place to start.

knitr is commonly used for R code, though it does support other 
programming languages including Python.

Take a look at the included `my_analysis.Rmd` file. It is a combination of 
Markdown-formatted text and R code. To build the html report, run the following 
in R:

    library(knitr)
    knit2html("my_analysis.Rmd")
    
This generates a few file, `my_analysis.html`, and a directory `figures/`, which 
contains the plots. Open `my_analysis.html` in a web browser to see the report, 
plots and all.

You can generate data reports with knitr wherever R is available - from the 
terminal window, in the console that comes with R, or in 
[Rstudio](http://www.rstudio.com). RStudio provides a single interface to edit 
the Rmd file, execute the code, and view the report side-by-side. The 
[RStudio documentation](http://www.rstudio.com/ide/docs/authoring/using_markdown) 
also has some nice general information on using R with Markdown.


# Work interactively on your code and notebook

In the knitr examples above, the source code and the report are separate 
entities. The report has all the code, but to conveniently re-execute the 
analysis you need the source too. Why not just make the report itself 
executable? That is what [iPython Notebook](http://ipython.org/notebook.html) 
has done. This project is progressing rapidly, and is well worth a look 
(particularly if most of your analyses are written in Python).

# Use a version control tool

In order for people to read, understand, and execute your analyses, you need to 
share the files with them. You will need to back up your files as you work on 
them, and sometimes keep track of different versions (eg, a version of the files 
that correspond to a published analysis, a version where you are trying a 
different approach to the analysis, and a version with changes suggested by a 
colleague). And most analyses are highly collaborative - different people are 
working on different parts, or developing code together. Managing all the files 
that are part of an analysis can start to be more work than the 
analysis itself.

Version control tools address all of these needs in a single, integrated 
framework. Using version control should become as routine as opening a text 
editor as you work on your project. It can feel like a steep learning curve at 
first, but your time will quickly be paid back.

Version control tools keep track of different versions of files, and can even 
help merge them when there are multiple conflicting versions that need to be 
integrated. These files can be all on one computer, or spread across multiple 
computers, so these tools are a natural framework for backup and collaboration.

[git](http://git-scm.com) is the most widely used version control system. There 
are multiple online tools for hosting git repositories, including 
[github](https://github.com) and [bitbucket](https://bitbucket.org/). These 
sites make it simple to post your code.

There are many 
[git tutorials](http://sixrevisions.com/resources/git-tutorials-beginners/) out 
there. Familiarize yourself with using git on your own computer at first, then 
sign up for a free account at one of the sites mentioned above and follow their 
instructions for posting your repository.